<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Red Bull Clicker - Billy Papastavros Edition</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

  :root {
    --bg-dark: #0e1014;
    --bg-light: #f9f9f9;
    --text-dark: #e0e0e0;
    --text-light: #1c1c1c;
    --red: #f9423a;
    --red-light: #ff6b63;
    --gray-dark: #181a1f;
    --gray-light: #ddd;
  }

  body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: var(--bg-dark);
    color: var(--text-dark);
    display: flex;
    justify-content: center;
    padding: 2rem 1rem 4rem;
    min-height: 100vh;
    transition: background 0.3s, color 0.3s;
  }
  body.light {
    background: var(--bg-light);
    color: var(--text-light);
  }

  #app {
    width: 900px;
    max-width: 100%;
    background: var(--gray-dark);
    border-radius: 16px;
    box-shadow: 0 16px 48px rgba(0,0,0,0.7);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: background 0.3s, color 0.3s;
  }
  body.light #app {
    background: #fff;
    color: var(--text-light);
    box-shadow: 0 8px 32px rgba(0,0,0,0.12);
  }

  header {
    position: sticky;
    top: 0;
    background: var(--gray-dark);
    border-bottom: 1px solid #2c2f3a;
    padding: 1rem 3rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 10;
    transition: background 0.3s;
  }
  body.light header {
    background: #eee;
    border-color: #ccc;
  }

  /* Updated title styling */
  #title-container {
    display: flex;
    flex-direction: column;
    user-select: none;
  }
  #title-container h1 {
    font-weight: 900;
    font-size: 3rem;
    color: var(--red);
    margin: 0;
  }
  #title-container small {
    font-weight: 500;
    font-size: 1rem;
    color: #bbb;
    margin-top: 0.2rem;
    user-select: none;
  }
  body.light #title-container small {
    color: #777;
  }

  .stats {
    display: flex;
    gap: 2.5rem;
    font-weight: 600;
    font-size: 1.3rem;
    color: #bbb;
    justify-content: center;
    margin-top: 0.7rem;
  }
  body.light .stats {
    color: #666;
  }
  .stats span {
    background: #2a2e39;
    padding: 0.5rem 1.5rem;
    border-radius: 12px;
    box-shadow:
      inset 2px 2px 5px #17191f,
      inset -2px -2px 5px #3b3f4a;
    user-select: none;
  }
  body.light .stats span {
    background: #eee;
    box-shadow:
      inset 2px 2px 5px #ccc,
      inset -2px -2px 5px #fff;
  }

  #milestone-slider-container {
    margin: 0 3rem 2.5rem 3rem; /* moved slider lower with bigger bottom margin */
    height: 16px;
    background: #2a2e39;
    border-radius: 12px;
    overflow: hidden;
  }
  body.light #milestone-slider-container {
    background: #eee;
  }
  #milestone-slider {
    height: 100%;
    background: var(--red);
    width: 0%;
    transition: width 0.3s ease;
  }

  main {
    display: flex;
    gap: 2rem;
    padding: 3rem;
    background: var(--gray-dark);
    height: 650px;
    transition: background 0.3s;
  }
  body.light main {
    background: #fafafa;
  }

  #clicker-section {
    flex: 1 1 350px;
    background: #23262f;
    border-radius: 16px;
    box-shadow:
      inset 3px 3px 6px #17191f,
      inset -3px -3px 6px #2c2f3a;
    display: flex;
    flex-direction: column;
    align-items: center;
    user-select: none;
    padding: 3rem 2rem;
    position: relative;
    transition: background 0.3s;
  }
  body.light #clicker-section {
    background: #fff;
    box-shadow:
      inset 3px 3px 6px #ccc,
      inset -3px -3px 6px #eee;
    color: var(--text-light);
  }

  #can-count {
    font-size: 5rem;
    font-weight: 800;
    color: var(--red);
    margin-bottom: 2rem;
    letter-spacing: 0.02em;
    user-select: text;
  }
  body.light #can-count {
    color: #d12f2f;
  }

  #redbull-can {
    width: 150px;
    height: 350px;
    background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Red_Bull_can_250ml.png/220px-Red_Bull_can_250ml.png') center/contain no-repeat;
    border-radius: 48px / 96px;
    cursor: pointer;
    filter: drop-shadow(0 6px 4px #f9423a55);
    transition: transform 0.1s ease;
  }
  #redbull-can:active {
    transform: scale(0.9);
  }

  #upgrades-section {
    flex: 1 1 480px;
    background: #22252f;
    border-radius: 16px;
    box-shadow:
      inset 3px 3px 7px #17191f,
      inset -3px -3px 7px #2c2f3a;
    padding: 2.5rem 2rem;
    display: flex;
    flex-direction: column;
    transition: background 0.3s;
  }
  body.light #upgrades-section {
    background: #fff;
    box-shadow:
      inset 3px 3px 7px #ccc,
      inset -3px -3px 7px #eee;
    color: var(--text-light);
  }

  #upgrades-section h2 {
    font-weight: 700;
    font-size: 2rem;
    margin-bottom: 1.5rem;
    color: var(--red);
    letter-spacing: 0.05em;
    user-select: none;
  }

  #upgrades-list {
    flex-grow: 1;
    overflow-y: auto;
    max-height: 520px;
    padding-right: 8px;
  }
  #upgrades-list::-webkit-scrollbar {
    width: 10px;
  }
  #upgrades-list::-webkit-scrollbar-track {
    background: transparent;
  }
  #upgrades-list::-webkit-scrollbar-thumb {
    background-color: var(--red);
    border-radius: 8px;
    border: 2px solid #1c1c1c;
  }
  body.light #upgrades-list::-webkit-scrollbar-thumb {
    border: 2px solid #fff;
  }

  .upgrade {
    background: #292d38;
    border-radius: 14px;
    margin-bottom: 1.25rem;
    padding: 1rem 1.5rem;
    box-shadow:
      4px 4px 6px #181a1f,
      -4px -4px 6px #2d303c;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: background 0.25s ease, box-shadow 0.25s ease, color 0.3s;
    position: relative;
  }
  .upgrade:hover:not(.disabled) {
    background: var(--red);
    color: #1c1c1c;
    box-shadow:
      0 0 12px 3px #f9423a99,
      inset 0 0 12px 1px #f9423a99;
  }
  .upgrade.disabled {
    opacity: 0.4;
    cursor: default;
    color: #888;
    box-shadow: none !important;
  }
  body.light .upgrade {
    background: #f4f4f4;
    color: var(--text-light);
  }
  body.light .upgrade.disabled {
    color: #aaa;
  }
  body.light .upgrade:hover:not(.disabled) {
    background: #ff6b63;
    color: #1c1c1c;
  }

  .upgrade-info {
    max-width: 70%;
  }
  .upgrade-name {
    font-weight: 700;
    font-size: 1.15rem;
    margin-bottom: 0.2rem;
  }
  .upgrade-desc {
    font-size: 0.9rem;
    color: #bbb;
  }
  body.light .upgrade-desc {
    color: #666;
  }

  .upgrade-cost {
    font-weight: 700;
    font-size: 1.2rem;
    min-width: 90px;
    text-align: right;
    user-select: none;
  }

  .upgrade-count {
    font-size: 0.85rem;
    color: var(--red-light);
    margin-top: 0.2rem;
    user-select: none;
  }
  body.light .upgrade-count {
    color: #ff3b3b;
  }

  footer {
    padding: 1rem 0 3rem 0;
    color: #555;
    font-size: 0.9rem;
    text-align: center;
    user-select: none;
  }
  body.light footer {
    color: #999;
  }

  #milestone-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    background: var(--red);
    color: #fff;
    border-radius: 16px;
    padding: 2rem 3rem;
    font-size: 1.8rem;
    font-weight: 700;
    text-align: center;
    box-shadow: 0 0 30px #f9423acc;
    user-select: none;
    pointer-events: none;
    z-index: 1000;
    transition: transform 0.3s ease-out;
  }
  #milestone-popup.show {
    transform: translate(-50%, -50%) scale(1);
    pointer-events: auto;
  }

  #milestone-popup button {
    margin-top: 1.5rem;
    background: #fff;
    color: var(--red);
    border: none;
    border-radius: 12px;
    padding: 0.5rem 1.5rem;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  #milestone-popup button:hover {
    background: #f0f0f0;
  }

  /* Confetti canvas */
  #confetti-canvas {
    position: fixed;
    pointer-events: none;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 1050;
  }

  /* Controls below header */
  #controls {
    display: flex;
    gap: 1rem;
    align-items: center;
  }
  button {
    background: var(--red);
    border: none;
    border-radius: 10px;
    color: #1c1c1c;
    font-weight: 600;
    padding: 0.6rem 1.2rem;
    cursor: pointer;
    font-size: 1rem;
    user-select: none;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #ff6b63;
  }
  body.light button {
    background: #ff6b63;
    color: #1c1c1c;
  }
  body.light button:hover {
    background: var(--red);
  }

  /* Responsive tweaks */
  @media (max-width: 800px) {
    main {
      flex-direction: column;
      padding: 2rem;
      height: auto;
    }
    #upgrades-section, #clicker-section {
      flex-basis: 100%;
      margin-bottom: 2rem;
    }
    #upgrades-list {
      max-height: 350px;
    }
  }
</style>
</head>
<body>

<div id="app" role="main" aria-label="Red Bull Clicker Game">
  <header>
    <div id="title-container" style="display:flex; flex-direction: column; user-select:none;">
      <h1 style="font-weight: 900; font-size: 3rem; color: var(--red); margin: 0;">RedBull Clicker</h1>
      <small style="font-weight: 500; font-size: 1rem; color: #bbb; margin-top: 0.2rem; user-select:none;">by Billy Papastavros</small>
    </div>
    <div id="controls" role="region" aria-label="Game controls">
      <button id="reset-btn" aria-label="Reset game">Reset</button>
      <button id="theme-toggle" aria-label="Toggle light or dark mode">Light Mode</button>
    </div>
  </header>

  <div class="stats" aria-live="polite" aria-atomic="true" style="justify-content:center; margin-top: 0.7rem;">
    <span>Cans: <strong id="total-cans">0</strong></span>
  </div>

  <div id="milestone-slider-container" aria-label="Milestone progress slider" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
    <div id="milestone-slider"></div>
  </div>

  <main>
    <section id="clicker-section" aria-label="Click Red Bull can to produce cans">
      <div id="can-count" aria-live="polite" aria-atomic="true">0</div>
      <div id="redbull-can" role="button" tabindex="0" aria-pressed="false" aria-label="Click to produce Red Bull cans"></div>
    </section>

    <section id="upgrades-section" aria-label="Upgrades Panel">
      <h2>Upgrades</h2>
      <div id="upgrades-list" role="list" tabindex="0" aria-label="List of upgrades"></div>
    </section>
  </main>

  <footer>
    Powered by Red Bull Energy &bull; Build your empire!
  </footer>
</div>

<div id="milestone-popup" role="dialog" aria-modal="true" aria-labelledby="milestone-message" aria-describedby="milestone-desc" tabindex="-1">
  <div id="milestone-message"></div>
  <button id="milestone-close-btn" aria-label="Close milestone popup">Close</button>
</div>

<canvas id="confetti-canvas"></canvas>

<script>
  let totalCans = 0;
  let cansPerClick = 1;

  const milestones = [50, 100, 250, 500, 1000, 2500, 5000, 10000, 25000, 50000, 100000, 500000, 1000000];
  let nextMilestoneIndex = 0;

  const upgrades = [
    { id: 'auto-filler', name: 'Auto Filler', description: 'Automatically produces 1 can per second.', baseCost: 50, cost: 50, cpsIncrease: 1, count: 0 },
    { id: 'energy-multiplier', name: 'Energy Multiplier', description: 'Doubles cans produced per click.', baseCost: 100, cost: 100, cpsIncrease: 0, multiplier: 2, count: 0, type: 'clickMultiplier' },
    { id: 'sponsor-deal', name: 'Sponsor Deal', description: 'Increases auto production by 5 cans per second.', baseCost: 800, cost: 800, cpsIncrease: 5, count: 0 },
    { id: 'premium-can', name: 'Premium Can', description: 'Triples cans per click.', baseCost: 2000, cost: 2000, cpsIncrease: 0, multiplier: 3, count: 0, type: 'clickMultiplier' },
    { id: 'viral-campaign', name: 'Viral Campaign', description: 'Adds 20 cans per second auto production.', baseCost: 10000, cost: 10000, cpsIncrease: 20, count: 0 },

    { id: 'red-bull-factory', name: 'Red Bull Factory', description: 'Produces 50 cans per second automatically.', baseCost: 50000, cost: 50000, cpsIncrease: 50, count: 0 },
    { id: 'marketing-expert', name: 'Marketing Expert', description: 'Quintuples cans per click.', baseCost: 100000, cost: 100000, cpsIncrease: 0, multiplier: 5, count: 0, type: 'clickMultiplier' },
    { id: 'supply-chain-upgrade', name: 'Supply Chain Upgrade', description: 'Adds 100 cans per second auto production.', baseCost: 250000, cost: 250000, cpsIncrease: 100, count: 0 },
    { id: 'global-sponsorship', name: 'Global Sponsorship', description: 'Decuples cans per click.', baseCost: 1000000, cost: 1000000, cpsIncrease: 0, multiplier: 10, count: 0, type: 'clickMultiplier' }
  ];

  let cansPerSecond = 0;
  let clickMultiplier = 1;

  // DOM Elements
  const canCountEl = document.getElementById('can-count');
  const totalCansEl = document.getElementById('total-cans');
  const upgradesListEl = document.getElementById('upgrades-list');
  const milestoneSlider = document.getElementById('milestone-slider');
  const milestonePopup = document.getElementById('milestone-popup');
  const milestoneMessage = document.getElementById('milestone-message');
  const milestoneCloseBtn = document.getElementById('milestone-close-btn');
  const redbullCan = document.getElementById('redbull-can');
  const resetBtn = document.getElementById('reset-btn');
  const themeToggleBtn = document.getElementById('theme-toggle');
  const milestoneSliderContainer = document.getElementById('milestone-slider-container');

  // --- Confetti setup ---
  const confettiCanvas = document.getElementById('confetti-canvas');
  const ctx = confettiCanvas.getContext('2d');
  let confettiParticles = [];
  let confettiActive = false;

  function setupConfettiCanvas() {
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;
  }
  window.addEventListener('resize', setupConfettiCanvas);
  setupConfettiCanvas();

  class ConfettiParticle {
    constructor(x, y) {
      this.x = x;
      this.y = y;
      this.size = Math.random() * 7 + 4;
      this.color = `hsl(${Math.floor(Math.random() * 360)}, 70%, 60%)`;
      this.speedX = (Math.random() - 0.5) * 10;
      this.speedY = Math.random() * -10 - 5;
      this.gravity = 0.3;
      this.rotation = Math.random() * 360;
      this.rotationSpeed = (Math.random() - 0.5) * 10;
      this.opacity = 1;
      this.life = 100;
    }
    update() {
      this.x += this.speedX;
      this.y += this.speedY;
      this.speedY += this.gravity;
      this.rotation += this.rotationSpeed;
      this.life--;
      this.opacity = Math.max(this.life / 100, 0);
    }
    draw() {
      ctx.save();
      ctx.translate(this.x, this.y);
      ctx.rotate((this.rotation * Math.PI) / 180);
      ctx.fillStyle = this.color;
      ctx.globalAlpha = this.opacity;
      ctx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size);
      ctx.restore();
    }
  }

  function startConfetti() {
    confettiActive = true;
    for (let i = 0; i < 150; i++) {
      confettiParticles.push(new ConfettiParticle(window.innerWidth / 2, window.innerHeight / 2));
    }
    requestAnimationFrame(confettiLoop);
  }

  function confettiLoop() {
    if (!confettiActive) return;
    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
    confettiParticles.forEach((p, idx) => {
      p.update();
      p.draw();
      if (p.life <= 0) confettiParticles.splice(idx, 1);
    });
    if (confettiParticles.length > 0) {
      requestAnimationFrame(confettiLoop);
    } else {
      confettiActive = false;
    }
  }

  // --- Game Logic ---

  function calculateCps() {
    cansPerSecond = upgrades.reduce((acc, upg) => acc + upg.cpsIncrease * upg.count, 0);
    clickMultiplier = 1;
    upgrades.forEach(u => {
      if (u.type === 'clickMultiplier') {
        clickMultiplier *= Math.pow(u.multiplier, u.count);
      }
    });
  }

  function updateUI() {
    canCountEl.textContent = totalCans.toLocaleString();
    totalCansEl.textContent = totalCans.toLocaleString();

    // Update milestone slider
    if (nextMilestoneIndex < milestones.length) {
      const currentMilestone = milestones[nextMilestoneIndex];
      const prevMilestone = nextMilestoneIndex > 0 ? milestones[nextMilestoneIndex - 1] : 0;
      let progress = (totalCans - prevMilestone) / (currentMilestone - prevMilestone);
      progress = Math.min(Math.max(progress, 0), 1);
      milestoneSlider.style.width = (progress * 100) + '%';
      milestoneSliderContainer.setAttribute('aria-valuenow', Math.floor(progress * 100));
      milestoneSliderContainer.setAttribute('aria-valuetext', `Progress to milestone ${currentMilestone}: ${Math.floor(progress * 100)}%`);
    } else {
      milestoneSlider.style.width = '100%';
      milestoneSliderContainer.setAttribute('aria-valuenow', 100);
      milestoneSliderContainer.setAttribute('aria-valuetext', `All milestones completed`);
    }

    // Update upgrades list
    upgradesListEl.innerHTML = '';
    upgrades.forEach(upg => {
      const disabled = totalCans < upg.cost;
      const upgradeEl = document.createElement('div');
      upgradeEl.className = 'upgrade' + (disabled ? ' disabled' : '');
      upgradeEl.setAttribute('role', 'listitem');
      upgradeEl.setAttribute('tabindex', disabled ? '-1' : '0');
      upgradeEl.setAttribute('aria-disabled', disabled.toString());

      upgradeEl.innerHTML = `
        <div class="upgrade-info">
          <div class="upgrade-name">${upg.name}</div>
          <div class="upgrade-desc">${upg.description}</div>
          <div class="upgrade-count">Owned: ${upg.count}</div>
        </div>
        <div class="upgrade-cost">${upg.cost.toLocaleString()}</div>
      `;
      upgradeEl.addEventListener('click', () => {
        if (!disabled) buyUpgrade(upg.id);
      });
      upgradeEl.addEventListener('keydown', (e) => {
        if ((e.key === 'Enter' || e.key === ' ') && !disabled) {
          e.preventDefault();
          buyUpgrade(upg.id);
        }
      });
      upgradesListEl.appendChild(upgradeEl);
    });
  }

  function buyUpgrade(id) {
    const upg = upgrades.find(u => u.id === id);
    if (!upg) return;
    if (totalCans >= upg.cost) {
      totalCans -= upg.cost;
      upg.count++;
      // Increase cost by 25% per purchase (faster growth)
      upg.cost = Math.floor(upg.baseCost * Math.pow(1.25, upg.count));
      calculateCps();
      updateUI();
    }
  }

  // Click handler on can
  redbullCan.addEventListener('click', () => {
    totalCans += cansPerClick * clickMultiplier;
    checkMilestones();
    updateUI();
  });
  redbullCan.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      totalCans += cansPerClick * clickMultiplier;
      checkMilestones();
      updateUI();
    }
  });

  // Auto increment cans every second
  setInterval(() => {
    if (cansPerSecond > 0) {
      totalCans += cansPerSecond;
      checkMilestones();
      updateUI();
    }
  }, 1000);

  // Milestone check & popup
  function checkMilestones() {
    if (nextMilestoneIndex >= milestones.length) return;
    if (totalCans >= milestones[nextMilestoneIndex]) {
      showMilestone(milestones[nextMilestoneIndex]);
      nextMilestoneIndex++;
    }
  }

  function showMilestone(value) {
    milestoneMessage.textContent = `Milestone reached: ${value.toLocaleString()} cans! 🎉`;
    milestonePopup.classList.add('show');
    milestonePopup.focus();
    startConfetti();
  }

  milestoneCloseBtn.addEventListener('click', () => {
    milestonePopup.classList.remove('show');
  });
  milestoneCloseBtn.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      milestonePopup.classList.remove('show');
      redbullCan.focus();
    }
  });

  // Reset game
  resetBtn.addEventListener('click', () => {
    if (confirm('Are you sure you want to reset your game progress?')) {
      totalCans = 0;
      upgrades.forEach(u => {
        u.count = 0;
        u.cost = u.baseCost;
      });
      nextMilestoneIndex = 0;
      calculateCps();
      updateUI();
    }
  });

  // Theme toggle
  themeToggleBtn.addEventListener('click', () => {
    document.body.classList.toggle('light');
    if (document.body.classList.contains('light')) {
      themeToggleBtn.textContent = 'Dark Mode';
    } else {
      themeToggleBtn.textContent = 'Light Mode';
    }
  });

  // Initial UI setup
  calculateCps();
  updateUI();
</script>

</body>
</html>
